{
  "summary": {
    "title": "Shell Injection Threat Model â€“ E-commerce",
    "owner": "Student",
    "description": "Threat model demonstrating shell injection in an e-commerce backend using STRIDE.",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Cassandra Gnaere"
      }
    ],
    "diagrams": [
      {
        "title": "Shell Injection Data Flow",
        "diagramType": "STRIDE",
        "id": 0,
        "diagramJson": {
          "cells": [
            {
              "type": "tm.Actor",
              "size": { "width": 160, "height": 80 },
              "position": { "x": 40, "y": 40 },
              "id": "actor-user",
              "attrs": {
                "text": { "text": "User / Browser" }
              }
            },
            {
              "type": "tm.Process",
              "size": { "width": 120, "height": 100 },
              "position": { "x": 260, "y": 140 },
              "id": "process-webapp",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Shell Injection via unvalidated input",
                  "type": "Tampering",
                  "description": "User input is concatenated into an OS command without validation, allowing command injection.",
                  "mitigation": "Avoid os.system(). Use safe APIs such as subprocess.run() without shell=True and validate input."
                }
              ],
              "attrs": {
                "text": { "text": "E-commerce Web Application" }
              }
            },
            {
              "type": "tm.Process",
              "size": { "width": 120, "height": 100 },
              "position": { "x": 520, "y": 140 },
              "id": "process-shell",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Arbitrary command execution",
                  "type": "Elevation of privilege",
                  "description": "Injected commands execute with application privileges.",
                  "mitigation": "Run services with least privilege and restrict OS command execution."
                },
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Sensitive file access",
                  "type": "Information disclosure",
                  "description": "Injected commands may read sensitive system files.",
                  "mitigation": "Restrict file access permissions and avoid shell invocation."
                }
              ],
              "attrs": {
                "text": { "text": "Operating System / Shell" }
              }
            },
            {
              "type": "tm.Store",
              "size": { "width": 160, "height": 80 },
              "position": { "x": 520, "y": 320 },
              "id": "store-files",
              "attrs": {
                "text": { "text": "File System" }
              }
            },
            {
              "type": "tm.Flow",
              "source": { "id": "actor-user" },
              "target": { "id": "process-webapp" },
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": { "text": "User Input (order ID / filename)" }
                  }
                }
              ],
              "id": "flow-user-webapp"
            },
            {
              "type": "tm.Flow",
              "source": { "id": "process-webapp" },
              "target": { "id": "process-shell" },
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": { "text": "OS Command Execution" }
                  }
                }
              ],
              "id": "flow-webapp-shell"
            },
            {
              "type": "tm.Flow",
              "source": { "id": "process-shell" },
              "target": { "id": "store-files" },
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": { "text": "File Operations" }
                  }
                }
              ],
              "id": "flow-shell-files"
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": { "x": 200, "y": 40 },
              "target": { "x": 200, "y": 300 },
              "id": "trust-boundary-user-app"
            }
          ]
        },
        "size": {
          "width": 800,
          "height": 500
        }
      }
    ]
  }
}
