{
  "summary": {
    "title": "Shell Injection Threat Model â€“ E-commerce Platform",
    "owner": "Cassandra Gnaere",
    "description": "STRIDE threat model demonstrating OS command injection risks in an e-commerce backend.",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Cassandra Gnaere"
      }
    ],
    "diagrams": [
      {
        "title": "Shell Injection Data Flow",
        "diagramType": "STRIDE",
        "id": 0,
        "diagramJson": {
          "cells": [
            {
              "type": "tm.Actor",
              "size": { "width": 160, "height": 80 },
              "position": { "x": 40, "y": 40 },
              "id": "actor-user",
              "attrs": {
                "text": { "text": "User / Browser" }
              }
            },
            {
              "type": "tm.Process",
              "size": { "width": 140, "height": 110 },
              "position": { "x": 260, "y": 160 },
              "id": "process-webapp",
              "privilegeLevel": "executionContext=Application",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Shell Injection via User Input",
                  "type": "Tampering",
                  "description": "User input is concatenated into an OS command without validation, enabling command injection.",
                  "mitigation": "Avoid os.system(); use subprocess.run() without shell=True and validate all input."
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Lack of Audit Logging",
                  "type": "Repudiation",
                  "description": "Injected commands may execute without being logged, preventing accountability.",
                  "mitigation": "Log all command execution attempts with user context."
                }
              ],
              "attrs": {
                "text": { "text": "E-commerce Web Application" }
              }
            },
            {
              "type": "tm.Process",
              "size": { "width": 140, "height": 110 },
              "position": { "x": 540, "y": 160 },
              "id": "process-shell",
              "privilegeLevel": "executionContext=OS",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Arbitrary Command Execution",
                  "type": "Elevation of privilege",
                  "description": "Injected commands execute with application-level OS privileges.",
                  "mitigation": "Apply least-privilege execution and disable unnecessary shell access."
                },
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Sensitive File Disclosure",
                  "type": "Information disclosure",
                  "description": "Attackers may read system or configuration files using injected commands.",
                  "mitigation": "Restrict file permissions and isolate execution environment."
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "System Resource Abuse",
                  "type": "Denial of service",
                  "description": "Injected commands may delete files or consume system resources.",
                  "mitigation": "Apply resource limits and input validation."
                }
              ],
              "attrs": {
                "text": { "text": "Operating System / Shell" }
              }
            },
            {
              "type": "tm.Store",
              "size": { "width": 160, "height": 80 },
              "position": { "x": 540, "y": 340 },
              "id": "store-files",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Unauthorized File Access",
                  "type": "Information disclosure",
                  "description": "Injected commands may read or modify sensitive files.",
                  "mitigation": "Apply strict filesystem permissions."
                }
              ],
              "attrs": {
                "text": { "text": "File System" }
              }
            },
            {
              "type": "tm.Flow",
              "source": { "id": "actor-user" },
              "target": { "id": "process-webapp" },
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": { "text": "HTTP Request (orderId / filename)" }
                  }
                }
              ],
              "id": "flow-user-webapp"
            },
            {
              "type": "tm.Flow",
              "source": { "id": "process-webapp" },
              "target": { "id": "process-shell" },
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": { "text": "OS Command Execution" }
                  }
                }
              ],
              "id": "flow-webapp-shell"
            },
            {
              "type": "tm.Flow",
              "source": { "id": "process-shell" },
              "target": { "id": "store-files" },
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": { "text": "File Read / Write / Delete" }
                  }
                }
              ],
              "id": "flow-shell-files"
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": { "x": 210, "y": 20 },
              "target": { "x": 210, "y": 420 },
              "id": "boundary-user-app"
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": { "x": 480, "y": 20 },
              "target": { "x": 480, "y": 420 },
              "id": "boundary-app-os"
            }
          ]
        },
        "size": {
          "width": 900,
          "height": 520
        }
      }
    ]
  }
}
